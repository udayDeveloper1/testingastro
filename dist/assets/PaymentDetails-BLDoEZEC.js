const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CustomButton-DXO1S32O.js","./vendor-Z3tYsDUR.js","./vendor-BI8wlGUX.css"])))=>i.map(i=>d[i]);
import{U as k,o as D,aF as I,Z as f,aS as L,aT as z,C as y,n as Y,_ as H}from"./index-CA7lLIcV.js";import{U as K,m as M,o as V,r,n as b,j as e,am as W,an as B,g as S}from"./vendor-Z3tYsDUR.js";import $ from"./ConfirmModal-CWGZRiNR.js";import"./CustomWhiteButton-DxPqXzdC.js";const G=""+new URL("mainLogo-CUa64V-i.webp",import.meta.url).href,J=""+new URL("celebration-D4wUMMaY.gif",import.meta.url).href,Z=r.lazy(()=>H(()=>import("./CustomButton-DXO1S32O.js"),__vite__mapDeps([0,1,2]),import.meta.url));function ce({openInModel:_=!1,paymentDetailsData:x={},onPaymentSuccess:A=()=>{}}){const{id:g}=K(),n=M(),N=V(),C=k(),[q,Q]=r.useState(""),{is_login:R,loginUserData:X}=b(t=>t?.masterSlice?.loginUser),j=b(t=>t?.masterSlice?.modal);b(t=>t?.masterSlice?.loader?.is_loading);const[ee,te]=r.useState(!1),[ae,oe]=r.useState(""),[v,T]=r.useState(!1),[h,w]=r.useState({}),[a,P]=r.useState({price:0,gst:0,totalAmount:0,addRechargeAmount:0,offerInPercentage:0,currency:"INR",currencySymbol:"â‚¹"}),E=async()=>{let t=S.cloneDeep(h);t.offer="";const o=parseFloat(t?.price)||0;let c=0,s=o;P(d=>({...d,addRechargeAmount:s,offerInPercentage:c})),w(t)},F=async()=>{n(f({is_loading:!0,loding_type:"payment"}));try{let o="";const c={amount:a?.addRechargeAmount,currency:a?.currency,receipt:`order_rcptid-${Date.now()}`,coupon_code:""};let s=await L(c);if(s?.code===1){if(o=s?.data?.order?.id,!v){alert("Razorpay SDK not loaded yet. Please try again in a moment."),n(f({is_loading:!1,loding_type:"payment"}));return}const d={key:y?.VITE_APP_RAZORPAY_KEY_ID,amount:a?.totalAmount*100,currency:a?.currency,name:"Chat My Astrologer App Recharge",description:"Test Transaction",image:G,prefill:{email:"",contact:""},handler:async function(l){let i={is_loading:!1,loding_type:"payment"},U={order_id:o,payment_id:l?.razorpay_payment_id,signature:`${Date.now()}`,extraPercentage:a?.offerInPercentage};try{let p=await z(U);if(p?.code===1){let u=localStorage.getItem(y.AUTH_KEY)?JSON.parse(localStorage.getItem(y.AUTH_KEY)):{};if(Object.keys(u)?.length>0){u.total_wallet_balance=p?.data?.total_wallet_balance,localStorage.setItem(y.AUTH_KEY,JSON.stringify(u));let O=S.cloneDeep(u);n(Y({is_login:R,loginUserData:O}))}_?A():N(C.CHATWITHASTROLOGERS)}}catch(p){console.error("Verification failed",p)}n(f(i))},config:{display:{preferences:{show_default_blocks:!0}}},modal:{ondismiss:function(){const l=window.confirm("Are you sure you want to close the payment form?");n(f({is_loading:!1,loding_type:"payment"}))}}};new window.Razorpay(d).open()}}catch{}};return r.useEffect(()=>{const t=document.createElement("script");return t.src="https://checkout.razorpay.com/v1/checkout.js",t.async=!0,t.onload=()=>T(!0),t.onerror=()=>console.error("Failed to load Razorpay SDK"),document.body.appendChild(t),()=>{document.body.removeChild(t)}},[]),r.useEffect(()=>{if(g||Object.keys(x)?.length>0){let t;if(Object.keys(x)?.length>0)t=x;else{const i=atob(g);t=Object.fromEntries(new URLSearchParams(i).entries())}w(t);const o=parseFloat(t?.price)||0,c=parseFloat((o*.18).toFixed(2)),s=parseFloat(t?.offer)||0,d=parseFloat((o+c).toFixed(2));let m=0,l=0;t?.type==="percentage"?(l=(o+o*s/100).toFixed(2),m=s):(l=(o+s).toFixed(2),m=(s*100/o).toFixed(2)),P(i=>({...i,price:o,gst:c,totalAmount:d,addRechargeAmount:l,offerInPercentage:m})),s!==""&&!_&&(D(n,"coupon_model"),setTimeout(()=>{I(n)},2e3))}},[g]),e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"pt-3",children:e.jsx("div",{className:"bg-white rounded-[10px]  w-full container padding100 mx-auto ",children:e.jsxs("div",{className:"shadow-[0px_0px_35px_0px_#0000000D] p-[15px] md:p-10 w-full rounded-[10px] max-w-[800px] mx-auto",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-3 md:mb-6",children:"Payment Details"}),e.jsxs("div",{className:"space-y-2 mb-6 border-[#F2ECF6] border  rounded-[10px] ",children:[e.jsxs("div",{className:"flex justify-between  commonLightBack rounded py-4 px-7 mb-0",children:[e.jsx("span",{className:"font-medium",children:"Total Amount"}),e.jsxs("span",{children:[a?.currencySymbol,a?.price]})]}),e.jsxs("div",{className:"flex justify-between py-4 px-7 border-t border-[#F2ECF6] border-b",children:[e.jsx("span",{className:"font-medium",children:"GST @ 18%"}),e.jsxs("span",{children:[a?.currencySymbol,a?.gst]})]}),e.jsxs("div",{className:"flex justify-between py-4 px-7",children:[e.jsx("span",{className:"font-medium",children:"Total Payable Amount"}),e.jsxs("span",{children:[a?.currencySymbol,a?.totalAmount]})]})]}),h?.offer!==""&&e.jsx("div",{className:"commonLightBack p-4 rounded-lg mb-6 ",children:e.jsxs("div",{className:"grid md:gap-5 md:grid-cols-[auto_3fr] items-start md:items-center ",children:[e.jsx("div",{className:"",children:e.jsx("p",{className:"website_color font-bold mb-0 text-[30px]",children:"%"})}),e.jsxs("div",{className:" flex justify-between flex-row items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"website_color font-bold mb-0",children:"Coupon Applied"}),e.jsxs("p",{className:"new_body_font md:text-lg  font-semibold mb-0",children:[a?.currencySymbol," ",h?.offer," ","Cashback in Wallet after Recharge"]})]}),e.jsx("div",{className:"bg_website_color rounded-[50%] p-1 w-[20px] h-[20px] flex items-center justify-center cursor-pointer",onClick:E,children:e.jsx(W,{icon:B,className:"text-white"})})]})]})}),e.jsx("div",{className:"w-full flex justify-between items-center",children:e.jsx(Z,{className:" text-white py-3 rounded font-medium",onClick:F,children:"PAY NOW"})})]})})}),e.jsx($,{isOpen:j?.is_model&&j?.model_type=="coupon_model",title:`Wow ${a?.offerInPercentage}% Coupon Applied!!`,description:"",okText:"",cancelText:"",imageSrc:J,imgClass:"max-w-[100px] mx-auto block mt-5"})]})}export{ce as default};
